data = Read10X_h5(filename = "data/5k_human_melanoma_tumor_CNIK_5pv2_filtered_feature_bc_matrix.h5")
packageVersion("Seurat")
library(Seurat)
library(Matrix)
library(tidyverse)
library(ggplot2)
library(Seurat)
library(Matrix)
library(tidyverse)
library(ggplot)
library(Seurat)
library(Matrix)
library(tidyverse)
library(ggplot2)
data = Read10X_h5(filename = "data/5k_human_melanoma_tumor_CNIK_5pv2_filtered_feature_bc_matrix.h5")
install.packages("hdf5f")
install.packages("hdf5r")
library(Seurat)
library(Matrix)
library(tidyverse)
library(ggplot2)
data = Read10X_h5(filename = "data/5k_human_melanoma_tumor_CNIK_5pv2_filtered_feature_bc_matrix.h5")
str(data)
counts = data$"Gene Expression"
data = Read10X_h5(filename = "data/5k_human_melanoma_tumor_CNIK_5pv2_filtered_feature_bc_matrix.h5")
str(data)
counts = data
class(data)
melanoma_seurat = CreateSeuratObject(counts = counts, project = "melanoma", min.cells = 3, min.features = 200)
str(melanoma_seurat)
melanoma_seurat
library(Seurat)
library(Matrix)
library(tidyverse)
library(ggplot2)
data = Read10X_h5(filename = "data/5k_human_melanoma_tumor_CNIK_5pv2_filtered_feature_bc_matrix.h5")
counts = data
melanoma_seurat = CreateSeuratObject(
counts = counts,
project = "melanoma",
min.cells = 3,
min.features = 200
)
melanoma_seurat[["percent.mt"]] = PercentageFeatureSet(
melanoma_seurat,
pattern = "^MT-"
)
VlnPlot(
melanoma_seurat,
features = c("nFeature_RNA", "nCount_RNA", "percent.mt"),
ncol = 3
)
melanoma_seurat = subset(
melanoma_object,
subset = nFeature_RNA > 200 &
nFeature_RNA < 2500 &
percent.mt < 5
)
melanoma_seurat = subset(
melanoma_seurat,
subset = nFeature_RNA > 200 &
nFeature_RNA < 2500 &
percent.mt < 5
)
library(Seurat)
library(Matrix)
library(tidyverse)
library(ggplot2)
data = Read10X_h5(filename = "data/5k_human_melanoma_tumor_CNIK_5pv2_filtered_feature_bc_matrix.h5")
counts = data
melanoma_seurat = CreateSeuratObject(
counts = counts,
project = "melanoma",
min.cells = 3,
min.features = 200
)
melanoma_seurat[["percent.mt"]] = PercentageFeatureSet(
melanoma_seurat,
pattern = "^MT-"
)
VlnPlot(
melanoma_seurat,
features = c("nFeature_RNA", "nCount_RNA", "percent.mt"),
ncol = 3
)
melanoma_seurat = subset(
melanoma_seurat,
subset = nFeature_RNA > 200 &
nFeature_RNA < 2500 &
percent.mt < 5
)
VlnPlot(
melanoma_seurat,
features = c("nFeature_RNA", "nCount_RNA", "percent.mt"),
ncol = 3
)
library(Seurat)
library(Matrix)
library(tidyverse)
library(ggplot2)
#Read in the file
data = Read10X_h5(filename = "data/5k_human_melanoma_tumor_CNIK_5pv2_filtered_feature_bc_matrix.h5")
counts = data
#Create the Seurat object
melanoma_seurat = CreateSeuratObject(
counts = counts,
project = "melanoma",
min.cells = 3,
min.features = 200
)
#Create a column for mitochondrial RNA percentage
melanoma_seurat[["percent.mt"]] = PercentageFeatureSet(
melanoma_seurat,
pattern = "^MT-"
)
#Filter for more than 200 genes, less than 500 genes, and less than 5% mitochondrial RNA
melanoma_seurat = subset(
melanoma_seurat,
subset = nFeature_RNA > 200 &
nFeature_RNA < 2500 &
percent.mt < 5
)
#Plot the resulting object
VlnPlot(
melanoma_seurat,
features = c("nFeature_RNA", "nCount_RNA", "percent.mt"),
ncol = 3
)
#Save the results
saveRDS(melanoma_seurat, file = "results/melanoma_seruat_filtered.rds")
library(Seurat)
library(Matrix)
library(tidyverse)
library(ggplot2)
melanoma_seurat = readRDS("results/melanoma_seurat_filtered.rds")
saveRDS(melanoma_seurat, file = "results/melanoma_seruat_filtered.rds")
melanoma_seurat = readRDS("results/melanoma_seurat_filtered.rds")
saveRDS(melanoma_seurat, file = "results/melanoma_seurat_filtered.rds")
melanoma_seurat = readRDS("results/melanoma_seurat_filtered.rds")
